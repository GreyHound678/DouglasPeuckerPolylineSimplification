The core algorithm was taken from here:

http://www.softsurfer.com/Archive/algorithm_0205/algorithm_0205.htm

